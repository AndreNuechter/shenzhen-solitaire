!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=3)}([function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return c})),n.d(e,"d",(function(){return a})),n.d(e,"e",(function(){return l})),n.d(e,"f",(function(){return d})),n.d(e,"g",(function(){return s})),n.d(e,"h",(function(){return i})),n.d(e,"i",(function(){return u})),n.d(e,"j",(function(){return f})),n.d(e,"k",(function(){return h})),n.d(e,"l",(function(){return g}));const r=[...document.getElementsByClassName("card-slot")],o=[...document.querySelectorAll('[data-slot-type="collection"]')],c=document.getElementsByClassName("consumed"),a=document.getElementById("dealers-hand"),l=[...document.querySelectorAll('[data-slot-type="dragon"]')],d=document.getElementById("dragon-summoning-btns"),s=document.querySelector('[data-slot-type="flower"]'),i=document.getElementById("reset-btn"),u=document.getElementById("score-display"),f=[...document.querySelectorAll('[data-slot-type="stacking"]')],h=document.getElementById("table"),g=document.getElementById("win-notification")},function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return a}));const r=["checked","textContent","data","onpointerdown","onpointerup"];function o(t){return e=>c(t.cloneNode(!1),e)}function c(t,e){return Object.keys(e).forEach(n=>{r.includes(n)?t[n]=e[n]:t.setAttribute(n,e[n])}),t}function a(t,e){return Array.prototype.indexOf.call(t,e)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return c})),n.d(e,"d",(function(){return a})),n.d(e,"e",(function(){return l}));const r=500,o={x:0,y:0,rx:5},c=8,a="http://www.w3.org/2000/svg",l=(128+c)*c+c},function(t,e,n){n(4),t.exports=n(5)},function(t,e,n){"use strict";n.r(e);var r=n(0),o=n(1),c=n(2);const a=document.createElementNS(c.d,"g"),l=Object(o.b)(document.createElementNS(c.d,"rect"),c.b),d=document.createElementNS(c.d,"text"),s=document.createElementNS(c.d,"use"),i={red:"#famine",black:"#war",green:"#biohazard",dragon:"#skull",flower:"#flower"},u=(t,e,n)=>{const r=a.cloneNode(!1),c=Object(o.a)(s)({width:"16px",height:"16px",href:t,stroke:e,fill:e}),l=Object(o.a)(c)({x:"4px",y:"4px"}),i=Object(o.a)(c)({x:"109px",y:"160px"}),u=Object(o.a)(c)({x:"32px",y:"60px",width:"64px",height:"64px"}),f=Object(o.a)(d)({x:"24px",y:"16px",textContent:n}),h=Object(o.a)(d)({x:"96px",y:"173px",textContent:n});return r.append(l,i,u,f,h),r},f=(t,e)=>{const n=Object(o.a)(a)({class:"card"}),r=l.cloneNode(!1),c=t&&""===e?u(i.dragon,t):t?u(i[t],t,e+1):u(i.flower,"hotpink");return n.append(r,c),Object.assign(n.dataset,{color:t,value:e}),n},h=["black","red","green"].flatMap(t=>Array.from({length:13},(e,n)=>f(t,n<=8?n:"")));h.push(f("",""));var g=h;const p=[/(\d)(,|\))/g,"$1px$2"],m=t=>t.getAttribute("transform").replace(...p),y={dragon:(t,e)=>1===t.children.length&&1===e.children.length,flower:({children:[{dataset:{color:t,value:e}}]})=>!e&&!t,collection:({children:t},{children:e})=>{const n=t[0].dataset,r=e[e.length-1].dataset;return 1===t.length&&(1===e.length&&"0"===n.value||+n.value==+r.value+1&&n.color===r.color)},stacking:({children:[{dataset:t}]},{children:e})=>{const n=e[e.length-1].dataset;return 1===e.length||n.value&&+t.value==+n.value-1&&t.color!==n.color}};function b({dataset:{color:t,value:e}},n,r){return n<r.length-1&&(+r[n+1].dataset.value!=e-1||r[n+1].dataset.color===t)}function x(t,e,n,o){const a=m(n),l=m(t),d=`${m(e)}translateY(${(e.children.length-1)*c.c*2*Number("stacking"===e.dataset.slotType)}px)`,s=[t,e,n,r.f];s.forEach(t=>{t.style.pointerEvents="none"}),o.append(n);n.animate({transform:[a+l,d],easing:["ease-in","ease-out"]},c.a).addEventListener("finish",()=>{e.append(n),s.forEach(t=>t.removeAttribute("style"))},{once:!0})}const v=t=>[t,t.getBoundingClientRect()];let E;function w(t){(function(t){for(let e=t.length-1;e>0;e-=1){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t})(t).forEach((t,e)=>r.j[e%8].append(t))}function k(){E=+(c.e/r.k.clientWidth).toFixed(2)}function O({target:t}){const e=t.closest(".dragon-summoning-btn");e&&e.classList.toggle("clicked")}Object.assign(r.f,{onclick:function({target:t}){const e=t.closest(".dragon-summoning-btn");if(!e)return;const{color:n}=e.dataset,o=[...r.j,...r.e].reduce((t,{children:e})=>{const{color:r,value:o}=e[e.length-1].dataset;return r!==n||o||t.push(e[e.length-1]),t},[]),c=r.e.find(({children:t})=>1===t.length||!t[1].dataset.value&&t[1].dataset.color===n);if(4===o.length&&c){const t=(t,e)=>{t.classList.add("frozen"),setTimeout(()=>x(t.parentElement,c,t,r.k),25*e)};o.forEach(t)}},onpointerdown:O,onpointerup:O}),r.h.onclick=function(){r.l.style.display="",r.a.forEach(t=>t.classList.remove("consumed")),g.forEach(t=>t.classList.remove("frozen")),w(g)},r.k.addEventListener("pointerdown",(function({target:t,x:e,y:n}){if(r.d.children.length)return;const c=t.closest(".card");if(!c)return;const a=c.parentNode;if(!a.classList.contains("card-slot"))return;const l=[...a.children].slice(Object(o.c)(a.children,c));if(l.some(b))return;const d=a.getAttribute("transform"),s=((t,e,n,o,c)=>({x:a,y:l})=>{var d,s;r.d.children.length||r.d.append(...c),r.d.setAttribute("transform",`${n}${d=(a-t)*o,s=(l-e)*o,`translate(${d},${s})`}`)})(e,n,d,E,l);r.d.setAttribute("transform",d),r.k.addEventListener("pointermove",s,{passive:!0}),r.k.addEventListener("pointerup",()=>{if(r.k.removeEventListener("pointermove",s),!r.d.children.length)return;const t=r.a.map(v),e=r.d.getBoundingClientRect(),n=function(t,e){const n={overlap:0,slot:null};return t.forEach(([t,r])=>{const o=(({x:t,y:e,width:n,height:r},{x:o,y:c,width:a,height:l})=>{const[d,s]=t>o&&e>c?[{x:t,y:e},{x:o+a,y:c+l}]:t<o&&e>c?[{x:o,y:e},{x:t+n,y:c+l}]:t>o&&e<c?[{x:t,y:c},{x:o+a,y:e+r}]:[{x:o,y:c},{x:t+n,y:e+r}];return(s.x-d.x)*(s.y-d.y)})(e,r);o>n.overlap&&Object.assign(n,{overlap:o,slot:t})}),n.slot}(t.filter(([t,n])=>{return c=n,!((o=e).right<c.left||o.left>c.right||o.bottom<c.top||o.top>c.bottom)&&function(t,e){return y[e.dataset.slotType](t,e)}(r.d,t);var o,c}),e)||a;[...r.d.children].forEach(t=>x(r.d,n,t,r.k))},{once:!0})}),{passive:!0}),r.l.onclick=()=>r.h.click(),window.addEventListener("DOMContentLoaded",()=>{w(g),k()}),window.onresize=k,window.ondblclick=function({x:t,y:e}){if(r.d.children.length)return;const n=document.elementFromPoint(t,e).closest(".card");if(!n)return;const o=n.parentElement;if(["flower","collection"].includes(o.dataset.slotType))return;if(o.lastChild!==n)return;const{color:c,value:a}=n.dataset;if(!a&&c)return;const l=(()=>{if(!a)return r.g;const t="0"===a?t=>1===t.children.length:({lastChild:{dataset:{color:t,value:e}}})=>t===c&&+e==a-1;return r.b.find(t)})();l&&x(o,l,n,r.k)}},function(t,e,n){"use strict";n.r(e);var r=n(2),o=n(0),c=n(1);const a=JSON.parse(localStorage.getItem("score"))||{score:0};var l=new Proxy(a,{set:(t,e,n)=>(Reflect.set(t,e,n),localStorage.setItem("score",JSON.stringify(t)),!0)});const d=t=>{t.classList.add("consumed"),7===o.c.length&&(l.score+=1,o.i.textContent=l.score+" times so far!",o.l.style.display="block")},s=(t,e)=>t.setAttribute("transform",`translate(0,${e*r.c*2})`),i=({addedNodes:[t]})=>{t.removeAttribute("transform"),t.classList.add("frozen")},u={collection:t=>e=>{e[0].addedNodes.length&&e.forEach(i),10===t.children.length&&d(t)},dragon:t=>e=>{e[0].addedNodes.length&&e.forEach(({addedNodes:t})=>{t.forEach(t=>s(t,0))}),t.children.length>2&&d(t)},flower:t=>e=>{e[0].addedNodes.length&&(e.forEach(i),d(t))},stacking:t=>e=>{e.forEach(({addedNodes:e})=>{e.forEach(e=>{s(e,Object(c.c)(t.children,e)-1)})})}};o.a.forEach(t=>{new MutationObserver(u[t.dataset.slotType](t)).observe(t,{childList:!0})})}]);